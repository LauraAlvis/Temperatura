# -*- coding: utf-8 -*-
import streamlit as st
import sys
import traceback

st.set_page_config(page_title="Convertidor Â°C â†” Â°F", page_icon="ğŸŒ¡ï¸", layout="centered")

def c_to_f(c: float) -> float:
    return (c * 9.0 / 5.0) + 32.0

def f_to_c(f: float) -> float:
    return (f - 32.0) * 5.0 / 9.0

def main():
    try:
        st.title("ğŸŒ¡ï¸ Convertidor de temperatura")
        st.write("Convierte entre **Celsius (Â°C)** y **Fahrenheit (Â°F)**. Elige el modo en la barra lateral.")

        # Sidebar: opciones
        st.sidebar.header("ConfiguraciÃ³n")
        mode = st.sidebar.radio("Modo", ("Celsius â†’ Fahrenheit", "Fahrenheit â†’ Celsius", "Bidireccional"))
        decimals = st.sidebar.slider("Decimales a mostrar", 0, 6, 2)

        # Form para evitar recargas inesperadas
        with st.form(key="conversion_form"):
            if mode == "Celsius â†’ Fahrenheit":
                c = st.number_input("Temperatura (Â°C):", value=0.0, format="%.2f", step=0.1)
                submit = st.form_submit_button("Convertir")
                if submit:
                    f = c_to_f(c)
                    st.success(f"{c:.{decimals}f} Â°C = {f:.{decimals}f} Â°F")
                    st.metric("Resultado (Â°F)", f"{f:.{decimals}f}")
            elif mode == "Fahrenheit â†’ Celsius":
                f = st.number_input("Temperatura (Â°F):", value=32.0, format="%.2f", step=0.1)
                submit = st.form_submit_button("Convertir")
                if submit:
                    c = f_to_c(f)
                    st.success(f"{f:.{decimals}f} Â°F = {c:.{decimals}f} Â°C")
                    st.metric("Resultado (Â°C)", f"{c:.{decimals}f}")
            else:  # Bidireccional
                c = st.number_input("Celsius (Â°C):", value=0.0, format="%.2f", step=0.1, key="c_bid")
                f = st.number_input("Fahrenheit (Â°F):", value=32.0, format="%.2f", step=0.1, key="f_bid")
                submit = st.form_submit_button("Actualizar")
                if submit:
                    # Si el usuario cambiÃ³ Celsius, calcular Fahrenheit; si cambiÃ³ Fahrenheit, calcular Celsius.
                    # Para simplicidad: recalculamos ambos y mostramos ambos resultados.
                    f_from_c = c_to_f(c)
                    c_from_f = f_to_c(f)
                    st.write(f"Desde {c:.{decimals}f} Â°C â†’ {f_from_c:.{decimals}f} Â°F")
                    st.write(f"Desde {f:.{decimals}f} Â°F â†’ {c_from_f:.{decimals}f} Â°C")

        st.markdown("---")
        st.subheader("FÃ³rmulas")
        st.latex(r"Â°F = (Â°C \times \frac{9}{5}) + 32")
        st.latex(r"Â°C = (Â°F - 32) \times \frac{5}{9}")

        with st.expander("InformaciÃ³n tÃ©cnica / Debug"):
            st.write(f"Python: `{sys.version.split()[0]}`")
            try:
                st.write(f"Streamlit: `{st.__version__}`")
            except Exception:
                st.write("No se pudo leer la versiÃ³n de Streamlit")
            st.write("Si la app aparece en blanco al desplegar, revisa los logs del servicio (Streamlit Cloud â†’ Manage app â†’ Logs).")
    except Exception as e:
        # Capturamos cualquier excepciÃ³n y la mostramos en la UI para evitar pantalla en blanco
        st.error("Se produjo un error al ejecutar la aplicaciÃ³n.")
        st.text("Traceback (informaciÃ³n tÃ©cnica):")
        st.text(traceback.format_exc())

if __name__ == "__main__":
    main()


